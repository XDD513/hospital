# 首页设计与实现方案

> **文档版本**: v1.0.0  
> **创建日期**: 2025-01-XX  
> **最后更新**: 2025-01-XX

---

## 1. 信息架构

### 1.1 版块划分

首页包含以下核心版块，按优先级和用户关注度排列：

1. **主视觉展示区（Hero Banner）**
   - 系统名称、个性化欢迎语
   - 当前日期与养生小贴士
   - 主要行动按钮（查看测试历史、浏览药膳推荐）

2. **核心功能入口（StatGrid）**
   - 体质测试次数（跳转测试历史）
   - 收藏药膳数量（跳转我的收藏）
   - 发布文章数量（跳转我的文章）
   - 连续打卡天数（跳转健康打卡）

3. **我的体质（ConstitutionPanel）**
   - 最新体质测试结果
   - 体质类型标签与描述
   - 测试时间
   - 养生建议（健康、饮食、运动）

4. **健康趋势（HealthTrend）**
   - 最近7天健康数据趋势图
   - 体重、睡眠、运动、心情四项指标
   - 使用 ECharts 可视化展示

5. **推荐药膳（RecipeList）**
   - AI 推荐药膳列表（最多3个）
   - 药膳图片、名称、功效
   - AI 推荐理由（如有）
   - 季节与体质标签

6. **养生知识（ArticleTimeline）**
   - 精选养生文章时间线
   - 文章标题、摘要、分类
   - 浏览量、评论数统计

---

## 2. 响应式布局

### 2.1 断点设计

| 断点 | 宽度范围 | 布局策略 |
|------|----------|----------|
| xs | < 576px | 单列布局，按钮全宽 |
| sm | ≥ 576px | 统计卡片2列，其他单列 |
| md | ≥ 768px | 统计卡片4列，药膳3列 |
| lg | ≥ 992px | 容器最大宽度1400px |
| xl | ≥ 1200px | 完整布局，右侧图标显示 |

### 2.2 移动端适配

- **Hero Banner**：隐藏右侧大图，按钮纵向堆叠
- **统计卡片**：2列布局，字号与间距调整
- **药膳卡片**：单列或2列，图片高度150px
- **图表**：保持响应式，自动调整尺寸

---

## 3. 交互与动画

### 3.1 进场动画

使用 `IntersectionObserver` + CSS Transition 实现模块进入视口后的淡入与上移：

```javascript
// 滚动动画指令
directives: {
  'animate-on-scroll': {
    mounted(el) {
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add('animate-in')
              observer.unobserve(entry.target)
            }
          })
        },
        { threshold: 0.1 }
      )
      observer.observe(el)
    }
  }
}
```

**动画参数**：
- 持续时间：200-300ms
- 缓动函数：`cubic-bezier(0, 0, 0.2, 1)`
- 初始状态：`opacity: 0; transform: translateY(20px)`
- 结束状态：`opacity: 1; transform: translateY(0)`

### 3.2 卡片 Hover 效果

统一规范：
- 阴影提升：`box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12)`
- 轻微抬升：`transform: translateY(-5px)`
- 过渡时间：`0.3s`

### 3.3 图表加载策略

- **延迟加载**：使用 `IntersectionObserver` 检测元素进入视口后再加载
- **按需导入**：ECharts 使用动态导入 `import('echarts')`，减少首屏体积
- **渐显效果**：加载完成后淡入显示

---

## 4. 性能优化

### 4.1 数据请求优化

**并行请求**：使用 `Promise.allSettled` 并行加载所有数据，即使部分失败也不影响其他数据：

```javascript
const results = await Promise.allSettled([
  getPatientStats(),
  getLatestTestResult(),
  getRecommendedRecipes(),
  getRecommendedArticles()
])
```

**优势**：
- 减少总加载时间（串行变并行）
- 提高容错性（部分失败不影响整体）
- 更好的用户体验（数据逐步展示）

### 4.2 资源加载优化

- **ECharts 按需加载**：仅在健康趋势模块进入视口时动态导入
- **图片懒加载**：使用 Element Plus `el-image` 的 `lazy` 属性
- **占位图**：使用 SVG data URL 作为默认占位，避免404请求

### 4.3 代码分割

- 首页组件独立打包，按需加载
- 路由懒加载已配置
- 减少首屏 JavaScript 体积

---

## 5. SEO 优化

### 5.1 Meta 标签

在 `index.html` 中添加：

```html
<meta name="keywords" content="中医体质辨识,医院预约,挂号系统,健康管理">
<meta name="description" content="中医体质辨识系统，提供体质测试、预约挂号、药膳推荐、健康管理等一站式服务">
```

### 5.2 Open Graph

```html
<meta property="og:type" content="website">
<meta property="og:title" content="中医体质辨识系统">
<meta property="og:description" content="提供体质测试、预约挂号、药膳推荐、健康管理等一站式服务">
```

### 5.3 JSON-LD 结构化数据

```html
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "中医体质辨识系统",
  "description": "提供体质测试、预约挂号、药膳推荐、健康管理等一站式服务"
}
</script>
```

### 5.4 路由 Meta 标题

在路由配置中完善 `meta.title`，与系统名称拼接：

```javascript
{
  path: '/patient/home',
  meta: { title: '首页 - 中医体质辨识系统' }
}
```

---

## 6. 组件规范

### 6.1 命名规范

所有首页组件使用 `Hsp` 前缀（Hospital System Prefix）：

- `HspHeroBanner` - 主视觉横幅
- `HspStatGrid` - 统计卡片网格
- `HspConstitutionPanel` - 体质面板
- `HspHealthTrend` - 健康趋势图表
- `HspRecipeList` - 推荐药膳列表
- `HspArticleTimeline` - 文章时间线

### 6.2 样式变量

统一使用 `home-variables.scss` 管理：

```scss
// 颜色变量
$primary-color: #52c41a;
$text-primary: #333;
$text-secondary: #666;

// 间距变量
$spacing-xs: 8px;
$spacing-sm: 12px;
$spacing-md: 16px;

// 阴影变量
$elevation-1: 0 2px 8px rgba(0, 0, 0, 0.08);
$elevation-2: 0 4px 12px rgba(0, 0, 0, 0.12);

// 动画变量
$transition-normal: 0.3s;
$ease-out: cubic-bezier(0, 0, 0.2, 1);
```

### 6.3 Props 设计

组件通过 Props 接收数据，保持数据驱动：

```vue
<HspStatGrid :stats="stats" />
<HspConstitutionPanel :constitution="latestConstitution" />
<HspRecipeList :recipes="recommendedRecipes" :loading="recipesLoading" />
```

---

## 7. 可用性优化

### 7.1 加载状态

- 使用 `v-loading` 指令显示加载状态
- 图表区域显示加载动画
- 列表数据为空时显示 `el-empty` 组件

### 7.2 错误处理

- 数据请求失败时使用默认值（统计为0，列表为空）
- 静默失败，不阻塞其他数据加载
- 用户友好的错误提示

### 7.3 空状态

- 未完成体质测试：不显示体质面板
- 无推荐药膳：显示空状态提示
- 无文章：显示空状态提示

---

## 8. 实现检查清单

- [x] 组件化拆分（6个独立组件）
- [x] 并行数据请求（Promise.allSettled）
- [x] ECharts 按需动态导入
- [x] IntersectionObserver 进场动画
- [x] 图片懒加载
- [x] SEO Meta 标签
- [x] JSON-LD 结构化数据
- [x] 响应式布局（5个断点）
- [x] 统一样式变量
- [x] 组件命名规范（Hsp前缀）

---

## 9. 后续优化建议

1. **Skeleton 占位**：数据加载时显示骨架屏，提升感知性能
2. **图片预加载**：关键图片提前加载，减少闪烁
3. **数据缓存**：使用 Pinia 缓存首页数据，减少重复请求
4. **性能监控**：集成 Web Vitals 监控首屏性能指标
5. **A/B 测试**：测试不同布局和内容对用户行为的影响

---

**文档结束**

