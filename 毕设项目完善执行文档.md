# 中医体质辨识与医院预约系统 - 毕设项目完善执行文档

> **文档版本**: v1.1.0  
> **创建日期**: 2025-01-XX  
> **最后更新**: 2025-01-XX  
> **项目状态**: 进行中

---

## 📋 文档说明

本文档用于指导毕设项目的功能完善和优化工作，所有功能开发、优化、修复都应参照本文档执行。文档会随着项目进展持续更新。

**使用说明**：
- ✅ 已完成的功能标记为 `[已完成]`
- 🔄 进行中的功能标记为 `[进行中]`
- ⏳ 待开始的功能标记为 `[待开始]`
- ❌ 已取消的功能标记为 `[已取消]`

---

## 📊 项目当前状态

### 已完成核心功能
- ✅ 用户认证与授权（JWT + Spring Security）
- ✅ 三端用户体系（患者、医生、管理员）
- ✅ 医院预约系统（科室、医生、排班、预约）
- ✅ 中医体质辨识系统（9种体质、66题问卷）
- ✅ 药膳推荐系统
- ✅ 穴位按摩指导
- ✅ 养生知识社区
- ✅ 健康档案管理
- ✅ 智能对话系统（WebSocket）
- ✅ 文件上传（OSS）
- ✅ 数据统计基础功能

### 技术栈
- **后端**: Spring Boot 2.7.18 + MyBatis-Plus + MySQL + Redis
- **前端**: Vue 3.3.4 + Element Plus + Pinia + Vite
- **实时通信**: WebSocket + STOMP
- **文件存储**: 阿里云OSS

---

## 🎯 功能完善清单

### 第一阶段：核心功能补充（必须完成）

#### 1. 数据可视化增强 ⏳

**1.1 患者健康趋势图表**
- [ ] 健康打卡数据趋势图（体重、睡眠、运动、心情）
  - 文件位置: `hospital-frontend/src/views/patient/health/HealthStatistics.vue`
  - 技术实现: ECharts 折线图、柱状图（使用现有的 `getHealthStatistics` 接口返回的 `weightTrend`、`sleepTrend`、`exerciseTrend` 数据）
  - 接口: 使用现有接口 `GET /api/health/statistics`，该接口已返回趋势数据
  - 验收标准: 能展示指定日期范围的健康数据趋势
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `feat: 完善患者健康趋势图表展示`

- [ ] 体质测试历史对比雷达图
  - 文件位置: `hospital-frontend/src/views/patient/constitution/TestHistory.vue`
  - 技术实现: ECharts 雷达图（使用现有的 `getTestHistory` 接口数据，前端实现多选对比）
  - 接口: 使用现有接口 `GET /api/constitution/test/history`，前端处理对比逻辑
  - 验收标准: 能对比不同时期的体质测试结果（至少2条记录）
  - 预计工时: 1.5天
  - **Git 提交**: 完成后提交 `feat: 添加体质测试历史对比雷达图功能`

**1.2 管理员数据大屏**
- [ ] 实时预约数据看板
  - 文件位置: `hospital-frontend/src/views/admin/Dashboard.vue`
  - 技术实现: ECharts 仪表盘、饼图、柱状图
  - 接口: 使用现有接口 `GET /api/statistics/admin` 和 `GET /api/statistics/monthly`，前端计算实时数据
  - 验收标准: 实时显示今日预约数、待处理数、完成数
  - 预计工时: 1.5天
  - **Git 提交**: 完成后提交 `feat: 添加管理员实时预约数据看板`

- [ ] 医生工作量统计
  - 文件位置: `hospital-frontend/src/views/admin/Statistics.vue`
  - 技术实现: ECharts 柱状图、折线图
  - 接口: 使用现有接口 `GET /api/statistics/doctor`，增强图表展示
  - 验收标准: 展示医生接诊量、预约量、评价统计
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `feat: 完善医生工作量统计图表展示`

- [ ] 科室预约热力图
  - 文件位置: `hospital-frontend/src/views/admin/Statistics.vue`
  - 技术实现: ECharts 热力图
  - 接口: 使用现有接口 `GET /api/statistics/department`，前端处理热力图数据格式
  - 验收标准: 展示各科室在不同时段的预约热度
  - 预计工时: 1.5天
  - **Git 提交**: 完成后提交 `feat: 添加科室预约热力图展示`

**后端实现位置**:
- `hospital-appointment-system/src/main/java/com/hospital/service/StatisticsService.java`
- `hospital-appointment-system/src/main/java/com/hospital/service/impl/StatisticsServiceImpl.java`
- `hospital-appointment-system/src/main/java/com/hospital/controller/StatisticsController.java`

---

#### 2. 消息通知系统完善 ⏳

**2.1 站内消息中心**
- [ ] 消息分类管理（系统通知、预约提醒、评价反馈等）
  - 文件位置: `hospital-frontend/src/views/patient/NotificationCenter.vue` (新建)
  - 技术实现: 消息分类标签、筛选功能
  - 接口: 扩展现有接口 `GET /api/patient/notifications?type=xxx&readStatus=xxx`
  - 验收标准: 能按类型筛选消息
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `feat: 创建消息中心页面，支持消息分类筛选`

- [ ] 消息已读/未读状态
  - 文件位置: `hospital-frontend/src/views/patient/NotificationCenter.vue`
  - 技术实现: 消息状态标记、未读数统计
  - 接口: 使用现有接口 `PUT /api/patient/notifications/{id}/read`
  - 验收标准: 点击消息后标记为已读，未读数实时更新
  - 预计工时: 0.5天
  - **Git 提交**: 完成后提交 `feat: 完善消息已读/未读状态功能`

- [ ] 批量标记已读
  - 文件位置: `hospital-frontend/src/views/patient/NotificationCenter.vue`
  - 技术实现: 全选功能、批量操作
  - 接口: 扩展 `NotificationController`，添加 `PUT /api/patient/notifications/read-all`
  - 验收标准: 能批量标记所有消息为已读
  - 预计工时: 0.5天
  - **Git 提交**: 完成后提交 `feat: 添加批量标记已读功能`

**2.2 消息推送优化**
- [ ] 预约成功/取消/提醒推送
  - 后端位置: `hospital-appointment-system/src/main/java/com/hospital/service/impl/AppointmentServiceImpl.java`
  - 技术实现: 在预约状态变更时调用 `NotificationService.createAndSendNotification` 发送通知
  - 验收标准: 预约状态变更时立即收到推送
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `feat: 添加预约状态变更消息推送`

- [ ] 医生回复提醒
  - 后端位置: `hospital-appointment-system/src/main/java/com/hospital/service/impl/ConversationServiceImpl.java`
  - 技术实现: 在发送消息时，如果是医生回复，调用 `NotificationService.createAndSendNotification` 发送通知
  - 验收标准: 医生回复时患者收到提醒
  - 预计工时: 0.5天
  - **Git 提交**: 完成后提交 `feat: 添加医生回复消息推送`

**后端实现位置**:
- `hospital-appointment-system/src/main/java/com/hospital/service/NotificationService.java`
- `hospital-appointment-system/src/main/java/com/hospital/service/impl/NotificationServiceImpl.java`
- `hospital-appointment-system/src/main/java/com/hospital/controller/NotificationController.java`

---

#### 3. 搜索功能增强 ⏳

**3.1 全局搜索**
- [ ] 统一搜索入口（医生、药膳、文章、穴位）
  - 文件位置: `hospital-frontend/src/components/SearchBox.vue` (新建)
  - 技术实现: 搜索框组件、搜索结果页，调用现有的各模块搜索接口
  - 接口: 使用现有接口组合（`/api/doctor/search`、`/api/recipe/search`、`/api/article/search`、`/api/acupoint/search`）
  - 验收标准: 能搜索所有类型的内容
  - 预计工时: 2天
  - **Git 提交**: 完成后提交 `feat: 创建全局搜索组件和搜索结果页`

- [ ] 搜索历史记录
  - 文件位置: `hospital-frontend/src/components/SearchBox.vue`
  - 技术实现: LocalStorage 存储搜索历史
  - 验收标准: 显示最近10条搜索记录
  - 预计工时: 0.5天
  - **Git 提交**: 完成后提交 `feat: 添加搜索历史记录功能`

- [ ] 热门搜索词
  - 文件位置: `hospital-frontend/src/components/SearchBox.vue`
  - 技术实现: 后端统计热门搜索词（使用 Redis 统计）
  - 接口: 新建 `GET /api/search/hot-keywords`
  - 验收标准: 显示热门搜索词标签
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `feat: 添加热门搜索词功能`

**3.2 高级筛选**
- [ ] 药膳筛选（体质、季节、功效）
  - 文件位置: `hospital-frontend/src/views/patient/recipe/RecipeList.vue`
  - 技术实现: 筛选器组件、多条件组合
  - 接口: 扩展现有接口 `GET /api/recipe/search`，添加筛选参数支持
  - 验收标准: 能按多个条件筛选药膳
  - 预计工时: 1.5天
  - **Git 提交**: 完成后提交 `feat: 添加药膳高级筛选功能`

- [ ] 文章筛选（分类、标签）
  - 文件位置: `hospital-frontend/src/views/patient/community/ArticleList.vue`
  - 技术实现: 标签筛选、分类筛选
  - 接口: 扩展现有接口 `GET /api/article/list`，添加筛选参数支持
  - 验收标准: 能按分类和标签筛选文章
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `feat: 添加文章高级筛选功能`

**后端实现位置**:
- `hospital-appointment-system/src/main/java/com/hospital/controller/SearchController.java` (新建)
- `hospital-appointment-system/src/main/java/com/hospital/service/SearchService.java` (新建)

---

#### 4. 项目文档完善 ⏳

**4.1 需求分析文档**
- [ ] 功能需求文档
  - 文件位置: `docs/需求分析文档.md` (新建)
  - 内容: 功能需求、非功能需求、用户故事
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `docs: 添加需求分析文档`

- [ ] 用例图
  - 文件位置: `docs/用例图.md` (新建)
  - 工具: PlantUML 或 Draw.io
  - 预计工时: 0.5天
  - **Git 提交**: 完成后提交 `docs: 添加用例图文档`

**4.2 系统设计文档**
- [ ] 系统架构图
  - 文件位置: `docs/系统架构设计.md` (新建)
  - 内容: 整体架构、技术选型、模块划分
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `docs: 添加系统架构设计文档`

- [ ] 数据库 ER 图
  - 文件位置: `docs/数据库设计.md` (新建)
  - 工具: MySQL Workbench 或 PowerDesigner
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `docs: 添加数据库设计文档`

- [ ] 接口设计文档完善
  - 文件位置: Swagger 自动生成
  - 要求: 所有接口添加详细注释和示例
  - 预计工时: 2天
  - **Git 提交**: 完成后提交 `docs: 完善接口设计文档注释`

**4.3 部署文档**
- [ ] 环境搭建指南
  - 文件位置: `docs/环境搭建指南.md` (新建)
  - 内容: 开发环境、生产环境搭建步骤
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `docs: 添加环境搭建指南`

- [ ] 部署步骤文档
  - 文件位置: `docs/部署文档.md` (新建)
  - 内容: 后端部署、前端部署、数据库初始化
  - 预计工时: 1天
  - **Git 提交**: 完成后提交 `docs: 添加部署步骤文档`

---

### 第二阶段：用户体验优化（建议完成）

#### 5. 数据导出功能 ⏳

**5.1 患者端导出**
- [ ] 导出健康报告（PDF）
  - 文件位置: `hospital-frontend/src/views/patient/health/HealthReport.vue`
  - 技术实现: 前端生成 PDF（jsPDF）或后端生成
  - 接口: `GET /api/health/report/export?format=pdf`
  - 验收标准: 能导出包含健康数据的 PDF 报告
  - 预计工时: 2天

- [ ] 导出预约记录（Excel）
  - 文件位置: `hospital-frontend/src/views/patient/MyAppointments.vue`
  - 技术实现: 后端生成 Excel（EasyExcel）
  - 接口: `GET /api/appointment/export?format=excel`
  - 验收标准: 能导出预约记录 Excel 文件
  - 预计工时: 1.5天

- [ ] 导出体质测试报告（PDF）
  - 文件位置: `hospital-frontend/src/views/patient/constitution/TestResult.vue`
  - 技术实现: 前端生成 PDF
  - 接口: `GET /api/constitution/test/{id}/export`
  - 验收标准: 能导出详细的体质测试报告
  - 预计工时: 1.5天

**5.2 管理员端导出**
- [ ] 导出统计数据（Excel）
  - 文件位置: `hospital-frontend/src/views/admin/Statistics.vue`
  - 技术实现: 后端生成 Excel
  - 接口: `GET /api/statistics/export?type=xxx`
  - 验收标准: 能导出各类统计数据
  - 预计工时: 1.5天

- [ ] 导出用户列表（Excel）
  - 文件位置: `hospital-frontend/src/views/admin/UserManage.vue`
  - 技术实现: 后端生成 Excel
  - 接口: `GET /api/user/export`
  - 验收标准: 能导出用户列表 Excel
  - 预计工时: 1天

**后端实现位置**:
- `hospital-appointment-system/src/main/java/com/hospital/controller/ExportController.java` (新建)
- 使用 EasyExcel 库生成 Excel

---

#### 6. 交互体验提升 ⏳

**6.1 骨架屏加载**
- [ ] 列表页骨架屏
  - 文件位置: 各列表页面组件
  - 技术实现: Element Plus Skeleton 组件
  - 验收标准: 数据加载时显示骨架屏
  - 预计工时: 1天

- [ ] 详情页骨架屏
  - 文件位置: 各详情页面组件
  - 技术实现: Element Plus Skeleton 组件
  - 验收标准: 数据加载时显示骨架屏
  - 预计工时: 1天

**6.2 操作反馈优化**
- [ ] 操作成功/失败提示优化
  - 文件位置: `hospital-frontend/src/plugins/message.js`
  - 技术实现: Element Plus Message 组件优化
  - 验收标准: 所有操作都有明确的反馈提示
  - 预计工时: 0.5天

- [ ] 空状态页面设计
  - 文件位置: 各列表页面
  - 技术实现: Element Plus Empty 组件 + 自定义样式
  - 验收标准: 无数据时显示友好的空状态提示
  - 预计工时: 1天

---

#### 7. 性能优化 ⏳

**7.1 前端性能优化**
- [ ] 路由懒加载优化
  - 文件位置: `hospital-frontend/src/router/index.js`
  - 技术实现: 确保所有路由使用动态导入
  - 验收标准: 首屏加载时间 < 2秒
  - 预计工时: 0.5天

- [ ] 图片懒加载
  - 文件位置: 全局组件或指令
  - 技术实现: `v-lazy` 指令或 IntersectionObserver
  - 验收标准: 图片进入视口时才加载
  - 预计工时: 1天

- [ ] 虚拟滚动（长列表）
  - 文件位置: 长列表页面（如医生列表、文章列表）
  - 技术实现: Element Plus 虚拟滚动或 vue-virtual-scroller
  - 验收标准: 长列表滚动流畅
  - 预计工时: 2天

**7.2 后端性能优化**
- [ ] 数据库查询优化
  - 文件位置: 各 Mapper XML 文件
  - 技术实现: 添加索引、优化 SQL、避免 N+1 查询
  - 验收标准: 接口响应时间 < 500ms
  - 预计工时: 2天

- [ ] 缓存策略优化
  - 文件位置: 各 Service 实现类
  - 技术实现: Redis 缓存热点数据
  - 验收标准: 缓存命中率 > 80%
  - 预计工时: 2天

---

### 第三阶段：技术亮点增强（可选）

#### 8. AI 推荐算法优化 ⏳

**8.1 智能推荐系统**
- [ ] 基于协同过滤的药膳推荐
  - 后端位置: `hospital-appointment-system/src/main/java/com/hospital/service/impl/AiRecommendationServiceImpl.java`
  - 技术实现: 用户行为分析、相似度计算
  - 验收标准: 推荐准确率提升
  - 预计工时: 3天

- [ ] 基于内容的推荐算法
  - 后端位置: `hospital-appointment-system/src/main/java/com/hospital/service/impl/AiRecommendationServiceImpl.java`
  - 技术实现: 特征提取、相似度匹配
  - 验收标准: 推荐结果更符合用户偏好
  - 预计工时: 3天

**8.2 个性化推荐**
- [ ] 根据历史行为推荐
  - 后端位置: `hospital-appointment-system/src/main/java/com/hospital/service/impl/AiRecommendationServiceImpl.java`
  - 技术实现: 用户画像构建、行为分析
  - 验收标准: 推荐结果个性化程度提升
  - 预计工时: 2天

---

#### 9. 移动端适配 ⏳

**9.1 响应式布局优化**
- [ ] 移动端菜单优化
  - 文件位置: `hospital-frontend/src/layout/*.vue`
  - 技术实现: 响应式设计、移动端菜单
  - 验收标准: 移动端体验良好
  - 预计工时: 2天

- [ ] 触摸手势支持
  - 文件位置: 全局或特定组件
  - 技术实现: 触摸事件处理
  - 验收标准: 支持滑动、下拉刷新等手势
  - 预计工时: 1.5天

---

#### 10. 安全增强 ⏳

**10.1 接口安全**
- [ ] 接口限流（Rate Limiting）
  - 后端位置: `hospital-appointment-system/src/main/java/com/hospital/config/RateLimitConfig.java` (新建)
  - 技术实现: Redis + Lua 脚本实现限流
  - 验收标准: 防止接口被恶意刷取
  - 预计工时: 2天

- [ ] 防刷机制
  - 后端位置: 各 Controller
  - 技术实现: 验证码、IP 限制
  - 验收标准: 能有效防止恶意请求
  - 预计工时: 1.5天

**10.2 数据安全**
- [ ] 敏感数据加密
  - 后端位置: 各 Service 实现类
  - 技术实现: AES 加密敏感字段
  - 验收标准: 敏感数据加密存储
  - 预计工时: 2天

---

### 第四阶段：测试与质量保证

#### 11. 单元测试 ⏳

**11.1 后端单元测试**
- [ ] Service 层测试
  - 文件位置: `hospital-appointment-system/src/test/java/com/hospital/service/`
  - 技术实现: JUnit 5 + Mockito
  - 验收标准: Service 层测试覆盖率 > 70%
  - 预计工时: 3天

- [ ] Controller 层测试
  - 文件位置: `hospital-appointment-system/src/test/java/com/hospital/controller/`
  - 技术实现: MockMvc
  - 验收标准: Controller 层测试覆盖率 > 60%
  - 预计工时: 2天

**11.2 前端单元测试**
- [ ] 组件测试
  - 文件位置: `hospital-frontend/src/components/__tests__/`
  - 技术实现: Vitest + Vue Test Utils
  - 验收标准: 关键组件有测试用例
  - 预计工时: 2天

---

#### 12. 集成测试 ⏳

**12.1 接口集成测试**
- [ ] 关键业务流程测试
  - 文件位置: `hospital-appointment-system/src/test/java/com/hospital/integration/`
  - 技术实现: Spring Boot Test
  - 验收标准: 关键业务流程测试通过
  - 预计工时: 2天

- [ ] 异常场景测试
  - 文件位置: `hospital-appointment-system/src/test/java/com/hospital/integration/`
  - 技术实现: Spring Boot Test
  - 验收标准: 异常场景处理正确
  - 预计工时: 1.5天

---

## 📅 实施计划

### 时间安排（建议）

**第一阶段（2-3周）**
- 数据可视化增强: 5-6天
- 消息通知系统完善: 3-4天
- 搜索功能增强: 4-5天
- 项目文档完善: 4-5天
- **小计**: 16-20天

**第二阶段（1-2周）**
- 数据导出功能: 4-5天
- 交互体验提升: 2-3天
- 性能优化: 4-5天
- **小计**: 10-13天

**第三阶段（1-2周）**
- AI 推荐算法优化: 5-8天
- 移动端适配: 3-4天
- 安全增强: 3-4天
- **小计**: 11-16天

**第四阶段（1周）**
- 单元测试: 5-7天
- 集成测试: 3-4天
- **小计**: 8-11天

**总计**: 45-60天（约 2-3 个月）

---

## ✅ 验收标准

### 功能验收
- [ ] 所有功能按需求实现
- [ ] 功能测试通过
- [ ] 用户体验良好
- [ ] 无明显 Bug

### 性能验收
- [ ] 首屏加载时间 < 2秒
- [ ] 接口响应时间 < 500ms（95% 请求）
- [ ] 数据库查询优化，无慢查询
- [ ] 缓存命中率 > 80%

### 代码质量
- [ ] 代码规范统一
- [ ] 关键代码有注释
- [ ] 无严重代码异味
- [ ] 测试覆盖率 > 60%

### 文档验收
- [ ] 需求分析文档完整
- [ ] 系统设计文档完整
- [ ] API 文档完整
- [ ] 部署文档完整

---

## 🔧 技术实现规范

### 代码规范
- **后端**: 遵循阿里巴巴 Java 开发手册
- **前端**: 遵循 Vue 3 官方风格指南
- **命名规范**: 驼峰命名、见名知意

### Git 提交规范
```
feat: 新功能
fix: 修复 Bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
perf: 性能优化
test: 测试相关
chore: 构建/工具相关
```

**重要：每次完成一个任务或功能成功后，必须进行 Git 提交**
- 提交前检查：确保代码编译通过、无 lint 错误
- 提交命令：
  ```bash
  git add .
  git commit -m "feat: [功能描述]"
  ```
- 提交时机：
  - 完成一个独立功能模块后
  - 修复一个 Bug 后
  - 完成一个任务清单项后
  - 代码通过测试验证后

### 分支管理
- `main`: 主分支，稳定版本
- `develop`: 开发分支
- `feature/xxx`: 功能分支
- `bugfix/xxx`: Bug 修复分支

---

## 📝 更新日志

### v1.1.0 (2025-01-XX)
- 添加 Git 提交要求：每次完成功能后必须提交
- 调整实现方案：优先使用现有接口，减少新建接口
- 优化工时估算

### v1.0.0 (2025-01-XX)
- 初始版本，创建执行文档
- 列出所有待完善功能
- 制定实施计划

---

## 📞 联系方式

如有问题或建议，请及时更新本文档。

---

**注意**: 本文档会随着项目进展持续更新，每次修改功能状态时请同步更新本文档。

